<html>
<head>
<link rel="stylesheet" href="css/style.css">
<script type="text/javascript" src="js/user.js"></script>
<script type="text/javascript" src="js/search.js"></script>
<script type="text/javascript" src="js/cookie.js"></script>
<script type="text/javascript" src="js/main.js"></script>
<script type="text/javascript"> document.addEventListener('DOMContentLoaded', function(){ getCookie();}, {once: true});</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="js/w3.js"></script>
<script> user = getUser(); 
</script>
</head>
<body>



<div class="topnav">
  <button class="navbutton" onclick="location.href='profile.html'">Profile</button>
  <button class="navbutton" onclick="location.href='search.html'">Search</button>
  <button class="navbutton" onclick="location.href='contract.html'" disabled>Contract</button>
</div>
<br>
<h2>Create a New Contract</h2>



<form onsubmit="return createContract();">
  <div class="row">
  <div class="column">
    <label for="hiring_user_id">Hiring User ID:</label><br>
    <input type="number" id="hireid" name="hireid" value=""><br>  
    <br>
  </div>
  <div class="column" id=hiringusername>
    <label for="hiring_user_id">Hiring User Name:</label><br>
    {{firstName}} {{lastName}}<br>
  </div>
  </div>
  <div id=recipientinfo>
    <select name="selectRecipient" id="selectRecipient" required>
      <option value="" selected="selected">Select Recipient</option>
    </select><br><br>
    {{address}}
  </div>
  <div class="row" id="contract">
	<br>
  	<div class="column">
          <label for="caregiverid">Caregiver ID:</label><br>
          <input type="number" id="cgid" name="cgid" value={{userID}} disabled><br>
          <label for="hours">Hours per Week:</label><br>
          <input type="number" id="hours" name="hours" value=""><br>
          <label for="start">Start Date:</label><br>
          <input type="date" id="start" name="start" value=""><br>
  	</div>
  	<div class="column">
          <label for="cgname">Caregiver name:</label><br>
          <input type="text" id="cgname" name="cgname" value="{{firstName}} {{lastName}}" disabled><br>
          <label for="rate">Payment Rate (per hour):</label><br>
          <input type="number" id="rate" name="rate" value=""><br>
          <label for="end">End Date:</label><br>
          <input type="date" id="end" name="end" value=""><br>
  	</div>
  </div>
  <br><br>
  <input type="submit" value="Submit">
</form> 

<script>
  console.log(user);
  w3.displayObject("contract", user);
  var recipientSelect = document.getElementById("selectRecipient");
  var employer = document.getElementById("hireid");

  employer.onchange = function() {
    searchID = employer.value;
    hiringUser = searchUser();
    recipientList = searchRecipientsByUser();
    
    w3.displayObject("hiringusername", hiringUser);

    for (let i = 0; i < recipientList.recipients.length; i++){
      let newOption = document.createElement("option");
      newOption.value = recipientList.recipients[i].userID;
      newOption.innerHTML = recipientList.recipients[i].firstName + " " + recipientList.recipients[i].lastName;
      recipientSelect.append(newOption);
    }
  }

  recipientSelect.onchange = function() {
    let currentOption = document.querySelector('#selectRecipient');
    w3.displayObject("recipientinfo", recipientList.recipients[currentOption.selectedIndex - 1]);
  }

</script>

</body>
</html>

